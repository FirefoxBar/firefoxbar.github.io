!function(){var n={};n.conf=function(){return{template:"template",dom:{main:document.querySelector("#main"),nav:document.querySelector("#nav"),logo:document.querySelector("#logo"),loading:document.querySelector("#loading"),menu:document.querySelector("#menu")}}}(),n.loading=function(e){n.conf.dom.loading.style.display=e?"block":"none"},n.menu=function(){function e(){n.conf.dom.nav.classList.contains("ex")?n.conf.dom.nav.classList.remove("ex"):n.conf.dom.nav.classList.add("ex")}n.conf.dom.menu.addEventListener("click",function(){e()},!1),n.conf.dom.nav.addEventListener("click",function(){e()},!1)},n.ajax=function(n,e){"string"==typeof n&&(n={url:n}),e&&(n.onload=e),n.method=n.method||"GET",n.body=n.body||"";var o=new XMLHttpRequest;o.onreadystatechange=function(){n.onreadystatechange&&n.onreadystatechange(o),4===o.readyState&&(200===o.status?n.onload&&n.onload.call(o):(console.error("Network fail: [%s] %s",n.method,n.url),n.onerror&&n.onerror.call(o)))},o.open(n.method,n.url,!0),o.responseType="text",o.send(n.body)},n.link=function(){for(var e=n.conf.dom.nav.querySelectorAll("a"),o=["mousedown","focus","touchstart"],t=function(n){var e=function(){n.href=n.href.replace(/^.*\/([^\/]*)\.html/,"#$1"),o.forEach(function(o){n.removeEventListener(o,e)})};o.forEach(function(o){n.addEventListener(o,e)})},r=0,a=e.length;a>r;r++)t(e[r])},n.nav=function(){var n=location.hash.replace(/^(#?)([^?#]*)((\?|#).*)?$/,"$2")||"home",e=document.querySelector(".cu");return e&&e.classList.remove("cu"),document.getElementById(n).classList.add("cu"),n},n.load=function(){var e=n.nav();n.conf.dom.main.innerHTML="",n.loading(!0),n.ajax({url:n.conf.template+"/"+e+".html",onload:function(){n.loading(!1);var e=function(n){var e=document.createElement("script");e.innerHTML=n.innerHTML,document.head.appendChild(e),setTimeout(function(){e.parentNode.removeChild(e)},0)},o=(new DOMParser).parseFromString(this.responseText,"text/html");n.conf.dom.main.innerHTML=o.querySelector("body").innerHTML;for(var t=o.querySelectorAll("head script.exec"),r=0,a=t.length;a>r;r++)e(t[r]);document.title=o.querySelector("title").textContent},onerror:function(){n.loading(!1),n.conf.domMain.innerHTML="<h2>_(:з」∠)__ 这里神马也木有……</h2>"}})},n.init=function(){n.load(),window.addEventListener("hashchange",n.load),n.link(),n.menu()},window.fxb=n,n.init()}();