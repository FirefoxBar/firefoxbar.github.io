!function(){var e={};e.conf=function(){return{clientID:"89dcce1a589176e7b4c2",clientSecret:"d1e5b29533f84ee8d4b37bca64ad07f76178ad73",template:"template",dom:{main:document.querySelector("#main"),nav:document.querySelector("#nav"),logo:document.querySelector("#logo"),loading:document.querySelector("#loading"),menu:document.querySelector("#menu")}}}(),e.loading=function(n){e.conf.dom.loading.style.display=n?"block":"none"},e.menu=function(){function n(){e.conf.dom.nav.classList.contains("ex")?e.conf.dom.nav.classList.remove("ex"):e.conf.dom.nav.classList.add("ex")}e.conf.dom.menu.addEventListener("click",function(){n()},!1),e.conf.dom.nav.addEventListener("click",function(){n()},!1)},e.ajax=function(e,n){"string"==typeof e&&(e={url:e}),n&&(e.onload=n),e.method=e.method||"GET",e.body=e.body||"";var o=new XMLHttpRequest;o.onreadystatechange=function(){e.onreadystatechange&&e.onreadystatechange(o),4===o.readyState&&(200===o.status?e.onload&&e.onload.call(o):(console.error("Network fail: [%s] %s",e.method,e.url),e.onerror&&e.onerror.call(o)))},o.open(e.method,e.url,!0),o.responseType="text",o.send(e.body)},e.link=function(){for(var n=e.conf.dom.nav.querySelectorAll("a"),o=["mousedown","focus","touchstart"],t=function(e){var n=function(){e.href=e.href.replace(/^.*\/([^\/]*)\.html/,"#$1"),o.forEach(function(o){e.removeEventListener(o,n)})};o.forEach(function(o){e.addEventListener(o,n)})},a=0,c=n.length;c>a;a++)t(n[a])},e.nav=function(){var e=location.hash.replace(/^(#?)([^?#]*)((\?|#).*)?$/,"$2")||"home",n=document.querySelector(".cu");return n&&n.classList.remove("cu"),document.getElementById(e).classList.add("cu"),e},e.load=function(){var n=e.nav();e.conf.dom.main.innerHTML="",e.loading(!0),e.ajax({url:e.conf.template+"/"+n+".html",onload:function(){e.loading(!1);var n=function(e){var n=document.createElement("script");n.innerHTML=e.innerHTML,document.head.appendChild(n),setTimeout(function(){n.parentNode.removeChild(n)},0)},o=(new DOMParser).parseFromString(this.responseText,"text/html");e.conf.dom.main.innerHTML=o.querySelector("body").innerHTML;for(var t=o.querySelectorAll("head script.exec"),a=0,c=t.length;c>a;a++)n(t[a]);document.title=o.querySelector("title").textContent},onerror:function(){e.loading(!1),e.conf.domMain.innerHTML="<h2>_(:з」∠)__ 这里神马也木有……</h2>"}})},e.init=function(){e.load(),window.addEventListener("hashchange",e.load),e.link(),e.menu()},window.fxb=e,e.init()}();